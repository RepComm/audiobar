!function(e){var t={};function n(s){if(t[s])return t[s].exports;var i=t[s]={i:s,l:!1,exports:{}};return e[s].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(s,i,function(t){return e[t]}.bind(null,i));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);const s=(e,t,n,s)=>{if(!e)throw"No element supplied";e.addEventListener(t,n,s)};class i{constructor(){this.eventListeners=new Array}mount(e){if(e instanceof HTMLElement)e.appendChild(this.element);else{if(!(e instanceof i))throw"Cannot append to parent because its not a Component or HTMLElement";e.element.appendChild(this.element)}return this}unmount(){return this.element.parentElement&&this.element.remove(),this}mountChild(e){if(e instanceof HTMLElement)this.element.appendChild(e);else{if(!(e instanceof i))throw"Cannot append child because its not a Component or HTMLElement";e.mount(this)}return this}on(e,t,n){return s(this.element,e,t,n),this.eventListeners.push({type:e,callback:t}),this}getRegisteredEvents(e,t){let n=new Array;for(let s of this.eventListeners)s.type==e&&s.callback==t&&n.push(s);return n}deleteRegisteredEvents(e,t){let n;for(let s=0;s<this.eventListeners.length;s++)n=this.eventListeners[s],e==n.type&&t==n.callback&&this.eventListeners.splice(s,1);return this}off(e,t){return((e,t,n)=>{if(!e)throw"No element supplied";e.removeEventListener(t,n)})(this.element,e,t),this.deleteRegisteredEvents(e,t),this}setId(e){return this.element.id=e,this}getId(){return this.element.id}addClasses(...e){return this.element.classList.add(...e),this}removeClasses(...e){return this.element.classList.remove(...e),this}removeAllListeners(){for(let e of this.eventListeners)this.off(e.type,e.callback);return this}static assignComponentToNative(e,t){e["component-namespace"]={component:t}}static removeComponentFromNative(e){e["component-namespace"]=void 0}make(e){return this.element&&(this.removeAllListeners(),i.removeComponentFromNative(this.element)),this.element=(e=>document.createElement(e))(e),i.assignComponentToNative(this.element,this),this}useNative(e){return this.element&&(this.removeAllListeners(),i.removeComponentFromNative(this.element)),e||console.warn("useNative was passed",e),this.element=e,this}setTextContent(e){return this.element.textContent=e,this}getTextContent(){return this.element.textContent}get rect(){return this.getRect()}getRect(){return this.element.getBoundingClientRect()}removeChildren(){for(;this.element.lastChild;)this.element.lastChild.remove();return this}click(){this.element.click()}setStyleItem(e,t){return this.element.style[e]=t,this}getStyleItem(e){return this.element.style[e]}for(e,t,n){for(let s=e;s<t+1;s++)n(this,s);return this}setAttr(e,t){return this.element[e]=t,this}getAttr(e){return this.element[e]}removeAttr(e){return this.element.removeAttribute(e),this}static nativeIsComponent(e){return null!=e["component-namespace"]&&null!=e["component-namespace"]}static nativeToComponent(e){if(!i.nativeIsComponent(e))throw"No component found in native "+e;return e["component-namespace"].component}}class r extends i{constructor(){super(),this.mutObserver=new MutationObserver(this.onElementMutate),this.enabled=!0}getEnabled(){return this.enabled}setEnabled(e){if(this.getEnabled()==e)return this;this.enabled=e,this.onEnable()}onEnable(){}make(e){return super.make(e),this.notifyElementChanged(),this.applyRootClasses(),this}onElementMutate(e,t){for(let t of e)t.type}notifyElementChanged(){return this.mutObserver.disconnect(),this.element&&this.mutObserver.observe(this.element,{subtree:!1,childList:!0}),this}applyRootClasses(){return this.addClasses("exponent"),this}}class a extends r{constructor(){super(),this.make("div"),this.addClasses("exponent-panel")}}class o extends a{constructor(){super(),this.container=new a,this.length=0,this.cx=0,this.cy=0,this.alignVertical="center",this.alignHorizontal="center",this.addClasses("exponent-square"),this.onResize=()=>{this.calcChildSize(),this.getEnabled()&&this.applyChildSize()},window.addEventListener("resize",this.onResize),this.container.mount(this),this.container.addClasses("exponent-square-container")}calcChildSize(){let e=Math.min(this.rect.width,this.rect.height),t=Math.max(this.rect.width,this.rect.height)-e,n=this.rect.width>this.rect.height;return this.length=Math.floor(e),n?(this.cy=0,"center"==this.alignHorizontal?this.cx=Math.floor(t/2):"left"==this.alignHorizontal?this.cx=0:this.cx=Math.floor(t)):(this.cx=0,"center"==this.alignVertical?this.cy=Math.floor(t/2):"top"==this.alignVertical?this.cy=0:this.cy=Math.floor(t)),this.cx+=this.rect.x,this.cy+=this.rect.y,this}applyChildSize(){return this.container.setStyleItem("width",this.length+"px"),this.container.setStyleItem("height",this.length+"px"),this.container.setStyleItem("left",this.cx+"px"),this.container.setStyleItem("top",this.cy+"px"),this}mountChild(e){return console.log("Square content",e),this.container.mountChild(e),setTimeout(()=>{this.calcChildSize(),this.applyChildSize()},100),this}setAlign(e,t){return this.alignHorizontal=e,this.alignVertical=t,this}}const h=["./images/knob01.svg","./images/knob02.svg","./images/knob03.svg","./images/knob04.svg","./images/knob05.svg","./images/knob06.svg","./images/knob07.svg"];class l extends o{constructor(){super(),this.min=0,this.max=1,this.minTurns=-.5,this.maxTurns=1.5,this.value=0,this.prevalue=0,this.turning=!1,this.turningx=0,this.turningy=0,this.step=0,this.addClasses("exponent-knob"),this.grab=(new a).addClasses("exponent-knob-grab").mount(this.container);let e=Math.floor(Math.random()*h.length);this.setImage(h[e]),this.grab.on("mousedown",e=>{e.preventDefault(),this.turning=!0,this.turningx=e.screenX,this.turningy=e.screenY}),s(window,"mouseup",e=>{this.turning=!1}),s(window,"mousemove",e=>{if(this.turning){let s=e.movementX-e.movementY;s*=l.sensitivity/(t=this.min,n=this.max,Math.abs(Math.abs(t)-Math.abs(n))),e.ctrlKey&&(s/=4),this.addValue(s)}var t,n}),this.setValue(0)}addValue(e){return this.setValue(this.prevalue+e),this}setValue(e){var t,n,s;this.prevalue=(t=e,n=this.min,s=this.max,Math.max(Math.min(t,s),n)),this.value=this.prevalue,0!=this.step&&(this.value=((e,t)=>{e<0&&(e-=t);let n=e%t;return n<=t?e-n:e+t-n})(this.value,this.step));let i=((e,t,n)=>e*(1-n)+t*n)(this.minTurns,this.maxTurns,((e,t,n)=>(n-e)/(t-e))(this.min,this.max,this.value));return this.grab.setStyleItem("transform",[`rotate(${i}turn)`]),this}getValue(){return this.value}setImage(e){return this.grab.setStyleItem("background-image",`url('${e}')`),this}}l.sensitivity=.005;const c=(new i).make("style").setId("exponent-built-in-styles").setTextContent("\n  .exponent {\n    flex: 1;\n  }\n  .exponent-panel {\n    display: flex;\n  }\n  .exponent-dual-panel {\n    display: flex;\n  }\n  .exponent-grid {\n    display: grid;\n  }\n  .exponent-button {\n    border: none;\n    cursor: pointer;\n  }\n  .exponent-knob-grab {\n    background-repeat: no-repeat;\n    background-position: 50% 50%;\n    background-size: contain;\n    cursor: grab;\n  }\n  .exponent-drawing {\n    min-width:0;\n  }\n  .exponent-square-container {\n  }\n  .exponent-list {\n    flex-wrap: wrap;\n    /* overflow:hidden; */\n  }\n  .exponent-list>* {\n    flex: 1;\n  }");const u=new TextDecoder;class d{static loadFromArrayBuffer(e,t){return new Promise((async function(n,s){let i;i=t||new d,i.arrayBuffer=e,n(i)}))}static load(e,t){return new Promise((async function(n,s){let i;i=t||new d,i.uri=e,i.response=await fetch(e),n(i)}))}}class m extends d{static loadFromArrayBuffer(e,t){return new Promise((async function(n,s){let i;i=t||new m,i=await d.loadFromArrayBuffer(e,i),i.text=await u.decode(i.arrayBuffer),n(i)}))}static load(e,t){return new Promise((async function(n,s){let i;i=t||new m,i=await d.load(e,i),i.text=await i.response.text(),n(i)}))}}class p extends m{static loadFromArrayBuffer(e,t,n="text/xml"){return new Promise((async function(s,i){let r;r=t||new p,r=await m.loadFromArrayBuffer(e,r),r.xml=p.DOM_PARSER.parseFromString(r.text,n),s(r)}))}static load(e,t,n="text/xml"){return new Promise((async function(s,i){let r;r=t||new p,r=await m.load(e,r),r.xml=p.DOM_PARSER.parseFromString(r.text,n),s(r)}))}}p.DOM_PARSER=new DOMParser;c.mount(document.head);(new r).make("style").setTextContent("\nbody {\n  margin: 0;\n  padding: 0;\n  left: 0;\n  top: 0;\n  width: 100vw;\n  height: 100vh;\n  background-color: black;\n  display: flex;\n}\ncanvas {\n  max-width: 100%;\n  max-height: 100%;\n}\n").mount(document.head);var g={ready:!1,smoothing:.6};window.setSmoothing=function(e){g.smoothing=e,g.analyser.smoothingTimeConstant=e};var f=(new a).setId("container").on("click",(function(){g.ready||(g.context=new AudioContext,g.analyser=new AnalyserNode(g.context,{channelCount:2,fftSize:256,smoothingTimeConstant:g.smoothing,maxDecibels:1}),g.analyserFrequencyData=new Uint8Array(128),g.amp=new GainNode(g.context),g.amp.connect(g.analyser),g.amp.gain.value=2,navigator.mediaDevices.getUserMedia({audio:!0}).then((function(e){g.source=g.context.createMediaStreamSource(e),g.ready=!0,g.source.connect(g.amp)})))})).mount(document.body),v=new class extends r{constructor(e){super(),this.renderPasses=new Array,this.autoClear=!0,this.autoResize=!1,this.needsRedraw=!0,this.pixelRatio=1,this.make("canvas"),this.addClasses("exponent-drawing"),this.context=this.element.getContext("2d",e),this.frameCallback=e=>{this.getEnabled()&&(this.needsRedraw&&this.render(),requestAnimationFrame(this.frameCallback))},requestAnimationFrame(this.frameCallback),this.onResize=()=>{this.autoResize&&this.setSize(Math.floor(this.rect.width*this.pixelRatio),Math.floor(this.rect.height*this.pixelRatio))},window.addEventListener("resize",this.onResize)}setNeedsRedraw(e=!0){return this.needsRedraw=e,this}hasRenderPass(e){return this.renderPasses.includes(e)}removeRenderPass(e){if(!this.hasRenderPass(e))throw"Cannot remove render pass, not in list";let t=this.renderPasses.indexOf(e);return this.renderPasses.splice(t,1),this}addRenderPass(e){if(this.hasRenderPass(e))throw"Cannot add render pass more than once";return this.renderPasses.push(e),this}get width(){return this.element.width}set width(e){this.element.width=e}get height(){return this.element.height}set height(e){this.element.height=e}setSize(e,t){return this.width=e,this.height=t,this.needsRedraw=!0,this}render(){this.needsRedraw=!1,this.autoClear&&this.context.clearRect(0,0,this.width,this.height);for(let e of this.renderPasses)e(this.context,this)}setHandlesResize(e){return this.autoResize=e,setTimeout(()=>{this.onResize(void 0)},100),this}}({}).setId("drawing").addRenderPass((function(e){if(e.save(),e.fillStyle="rgba(0,0,0,0.1)",e.fillRect(0,0,v.width,v.height),e.restore(),!g.ready)return e.strokeStyle="white",void e.strokeText("Waiting on audio context, click to start if you haven't already.",10,10);g.analyser.getByteFrequencyData(g.analyserFrequencyData);var t,n=0,s=0,i=g.analyserFrequencyData.length,r=0,a=(v.width,0),o=0,h=0;e.save(),e.setLineDash([1,12]),e.lineCap="round",e.lineWidth=1;for(var l=0;l<i;l++)r=l/i*v.width,(n=g.analyserFrequencyData[l])>.001&&(n+=l*l/(1.5*i)),s=n/255*v.height,e.lineWidth=n/255*10,a=10+((o=10+l/i)*(1-(t=n/255))+(h=10+n)*t),(n>128||1/n+.1>l)&&(a=255),l%4==0&&(a*=4,o*=4,h*=4),e.strokeStyle="rgb(".concat(a%255,",").concat(o%255,",").concat(h%255,")"),e.beginPath(),e.moveTo(r,0),e.lineTo(r,s),e.stroke();e.restore()})).setHandlesResize(!0).mount(f);v.autoClear=!1;setInterval((function(){v.setNeedsRedraw(!0)}),1e3/24)}]);